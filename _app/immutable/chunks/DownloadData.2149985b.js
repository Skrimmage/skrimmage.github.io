import{a as G,t as H,l as P}from"./formatting.380bfe66.js";import{h as X,E as Y,T as Q}from"./index.6730dd29.js";import{S as W,i as Z,s as $,b as k,m as F,z as v,A as ee,B as C,C as te,f as y,L as O,R as q,v as ne,e as w,t as ie,a as oe,d as S,g,j as se,c as le,k as d,ab as A,n as T,x as ae,_ as ue,T as fe,D as re,E as ce,F as de,X as me,Y as I,M as x,N as z,o as he}from"./index.fa6138d3.js";import{a as _e}from"./VennDiagram.svelte_svelte_type_style_lang.873530f1.js";import{f as L}from"./index.a5cc338a.js";function pe(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function*ye(n,t){if(t===void 0)for(let e of n)e!=null&&(e=+e)>=e&&(yield e);else{let e=-1;for(let i of n)(i=t(i,++e,n))!=null&&(i=+i)>=i&&(yield i)}}class be{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let o=0;o<this._n&&o<32;o++){const s=e[o],a=t+s,l=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);l&&(e[i++]=l),t=a}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e=this._n,i,o,s,a=0;if(e>0){for(a=t[--e];e>0&&(i=a,o=t[--e],a=i+o,s=o-(a-i),!s););e>0&&(s<0&&t[e-1]<0||s>0&&t[e-1]>0)&&(o=s*2,i=a+o,o==i-a&&(a=i))}return a}}function J(n,t){const e=new be;if(t===void 0)for(let i of n)(i=+i)&&e.add(i);else{let i=-1;for(let o of n)(o=+t(o,++i,n))&&e.add(o)}return+e}function M(n,t){let e;if(t===void 0)for(const i of n)i!=null&&(e<i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let o of n)(o=t(o,++i,n))!=null&&(e<o||e===void 0&&o>=o)&&(e=o)}return e}function E(n,t){let e;if(t===void 0)for(const i of n)i!=null&&(e>i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let o of n)(o=t(o,++i,n))!=null&&(e>o||e===void 0&&o>=o)&&(e=o)}return e}function V(n,t,e=0,i=n.length-1,o=pe){for(;i>e;){if(i-e>600){const u=i-e+1,m=t-e+1,p=Math.log(u),h=.5*Math.exp(2*p/3),f=.5*Math.sqrt(p*h*(u-h)/u)*(m-u/2<0?-1:1),c=Math.max(e,Math.floor(t-m*h/u+f)),r=Math.min(i,Math.floor(t+(u-m)*h/u+f));V(n,t,c,r,o)}const s=n[t];let a=e,l=i;for(b(n,e,t),o(n[i],s)>0&&b(n,e,i);a<l;){for(b(n,a,l),++a,--l;o(n[a],s)<0;)++a;for(;o(n[l],s)>0;)--l}o(n[e],s)===0?b(n,e,l):(++l,b(n,l,i)),l<=t&&(e=l+1),t<=l&&(i=l-1)}return n}function b(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function Te(n,t,e){if(n=Float64Array.from(ye(n,e)),!!(i=n.length)){if((t=+t)<=0||i<2)return E(n);if(t>=1)return M(n);var i,o=(i-1)*t,s=Math.floor(o),a=M(V(n,s).subarray(0,s+1)),l=E(n.subarray(s+1));return a+(l-a)*(o-s)}}function ge(n,t){return Te(n,.5,t)}function U(n,t){return i=>{t=t??{};const o={},s=Object.keys(n);for(const a of s)o[a]=n[a](i);if(t.rest&&i.length){const a=Object.keys(i[0]);for(const l of a)s.includes(l)||(o[l]=t.rest(l)(i))}return[o]}}function R(){return n=>n.length}function De(n){const t=typeof n=="function"?n:e=>e[n];return e=>J(e,t)}function ve(n,t){let e=0;for(let i=0;i<n.length;++i){const o=t(n[i],i,n);+o===o&&(e+=1)}return e?J(n,t)/e:void 0}function we(n){const t=typeof n=="function"?n:e=>e[n];return e=>E(e,t)}function Se(n){const t=typeof n=="function"?n:e=>e[n];return e=>M(e,t)}function Ce(n){const t=typeof n=="function"?n:e=>e[n];return e=>ve(e,t)}function Me(n){const t=typeof n=="function"?n:e=>e[n];return e=>ge(e,t)}function B(n,t={}){const e=typeof n=="function"?n:i=>i[n];return i=>{const o=new Map;let s=0;for(const a of i){const l=e(a);if(!o.has(l)){if(!t.includeUndefined&&l===void 0||t.includeNull===!1&&l===null)continue;s+=1,o.set(l,!0)}}return s}}function Ee(n,t){let e=G(n,t),i=["id","gdp"],o=["of","the","and","in","on"];function s(a){return a.replace(/\S*/g,function(l){return!i.includes(l)&&!o.includes(l)?l.charAt(0).toUpperCase()+l.substr(1).toLowerCase():i.includes(l)?l.toUpperCase():l.toLowerCase()})}return e=s(e.replace(/_/g," ")),e}function K(n,t,e=!0){const i=H(n,U(e?{count:R(),countDistinct:B(t),min:we(t),max:Se(t),median:Me(t),mean:Ce(t),sum:De(t)}:{count:R(),countDistinct:B(t)}))[0],{maxDecimals:o,unitType:s}=Fe(n.map(a=>a[t]));return{min:i.min,max:i.max,median:i.median,mean:i.mean,count:i.count,countDistinct:i.countDistinct,sum:i.sum,maxDecimals:o,unitType:s}}function Fe(n){var t;if(n==null||n.length===0)return{maxDecimals:0,unitType:"unknown"};{let e=0;for(const i of n){const o=(t=i==null?void 0:i.toString().split(".")[1])==null?void 0:t.length;o>e&&(e=o)}return{maxDecimals:e,unitType:"number"}}}function Le(n,t="object"){const e={},i=X(n);for(const o of Object.keys(n[0])){const s=i.find(m=>{var p;return((p=m.name)==null?void 0:p.toLowerCase())===(o==null?void 0:o.toLowerCase())})??{name:o,evidenceType:Y.STRING,typeFidelity:Q.INFERRED},a=s.evidenceType;let l=s.evidenceType==="number"?K(n,o,!0):K(n,o,!1);s.evidenceType!=="number"&&(l.maxDecimals=0,l.unitType=s.evidenceType);const u=P(o,s,l);e[o]={title:Ee(o,u),type:a,evidenceColumnType:s,format:u,columnUnitSummary:l}}return t!=="object"?Object.entries(e).map(([o,s])=>({id:o,...s})):e}function N(n){let t,e,i,o,s,a,l,u,m,p;const h=n[7].default,f=ne(h,n,n[6],null),c=f||je();return{c(){t=w("div"),e=w("button"),i=w("span"),o=ie(n[1]),s=oe(),c&&c.c(),this.h()},l(r){t=S(r,"DIV",{});var _=g(t);e=S(_,"BUTTON",{type:!0,"aria-label":!0,class:!0});var D=g(e);i=S(D,"SPAN",{});var j=g(i);o=se(j,n[1]),j.forEach(y),s=le(D),c&&c.l(D),D.forEach(y),_.forEach(y),this.h()},h(){d(e,"type","button"),d(e,"aria-label",n[1]),d(e,"class",a=A(n[4].class)+" svelte-p80uux")},m(r,_){F(r,t,_),T(t,e),T(e,i),T(i,o),T(e,s),c&&c.m(e,null),u=!0,m||(p=ae(e,"click",function(){ue(n[3](n[0]))&&n[3](n[0]).apply(this,arguments)}),m=!0)},p(r,_){n=r,(!u||_&2)&&fe(o,n[1]),f&&f.p&&(!u||_&64)&&re(f,h,n,n[6],u?de(h,n[6],_,null):ce(n[6]),null),(!u||_&2)&&d(e,"aria-label",n[1]),(!u||_&16&&a!==(a=A(n[4].class)+" svelte-p80uux"))&&d(e,"class",a)},i(r){u||(v(c,r),r&&me(()=>{l||(l=I(t,L,{duration:200},!0)),l.run(1)}),u=!0)},o(r){C(c,r),r&&(l||(l=I(t,L,{duration:200},!1)),l.run(0)),u=!1},d(r){r&&y(t),c&&c.d(r),r&&l&&l.end(),m=!1,p()}}}function je(n){let t,e;return{c(){t=x("svg"),e=x("path"),this.h()},l(i){t=z(i,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0});var o=g(t);e=z(o,"path",{d:!0}),g(e).forEach(y),o.forEach(y),this.h()},h(){d(e,"d","M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"),d(t,"width","12"),d(t,"height","12"),d(t,"viewBox","0 0 24 24"),d(t,"fill","none"),d(t,"stroke-width","2"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round")},m(i,o){F(i,t,o),T(t,e)},p:he,d(i){i&&y(t)}}}function ke(n){let t,e,i=n[2]&&N(n);return{c(){i&&i.c(),t=k()},l(o){i&&i.l(o),t=k()},m(o,s){i&&i.m(o,s),F(o,t,s),e=!0},p(o,[s]){o[2]?i?(i.p(o,s),s&4&&v(i,1)):(i=N(o),i.c(),v(i,1),i.m(t.parentNode,t)):i&&(ee(),C(i,1,1,()=>{i=null}),te())},i(o){e||(v(i),e=!0)},o(o){C(i),e=!1},d(o){i&&i.d(o),o&&y(t)}}}function Oe(n,t,e){let{$$slots:i={},$$scope:o}=t,{data:s}=t,{queryID:a}=t,{text:l="Download"}=t,{display:u}=t;const m=new Date,p=new Date(m.getTime()-m.getTimezoneOffset()*6e4).toISOString().slice(0,19).replaceAll(":","-");let{downloadData:h=f=>{const c={fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,filename:(a??"evidence_download")+` ${p}`,useTextFile:!1,useBom:!0,useKeysAsHeaders:!0},r=JSON.parse(JSON.stringify(Array.from(f)));new _e.ExportToCsv(c).generateCsv(r)}}=t;return n.$$set=f=>{e(4,t=O(O({},t),q(f))),"data"in f&&e(0,s=f.data),"queryID"in f&&e(5,a=f.queryID),"text"in f&&e(1,l=f.text),"display"in f&&e(2,u=f.display),"downloadData"in f&&e(3,h=f.downloadData),"$$scope"in f&&e(6,o=f.$$scope)},t=q(t),[s,l,u,h,t,a,o,i]}class Ue extends W{constructor(t){super(),Z(this,t,Oe,ke,$,{data:0,queryID:5,text:1,display:2,downloadData:3})}}export{Ue as D,Le as g};
