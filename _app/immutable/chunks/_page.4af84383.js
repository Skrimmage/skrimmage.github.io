import{S as ae,i as ne,s as oe,a as R,e as U,b as Y,G as S,c as M,h as ie,d as D,f as l,g as ue,H as v,k as A,m as E,n as G,I,z as q,B as C,C as me,J as L,p as B,q as ce,r as J,u as fe,U as _e,o as Q,A as le,V as pe}from"./index.fa6138d3.js";import{p as de}from"./stores.aa260a3e.js";import{s as ye,Q as W,p as he,r as Z,d as $e}from"./index.f69da284.js";import{w as be}from"./paths.cea13cf3.js";import{I as ke,C as ge}from"./globalContexts.8bcf5d41.js";import{p as x}from"./profile.e7706513.js";import{L as Ee,a as z}from"./Links.4783c80d.js";import"./VennDiagram.svelte_svelte_type_style_lang.522b73ff.js";import{Q as qe}from"./QueryViewer.9332a90a.js";import{V as we}from"./Value.55425bbe.js";function Ce(a){return{c(){this.h()},l(n){this.h()},h(){document.title="Evidence"},m:Q,p:Q,d:Q}}function ee(a){let n,r;return n=new qe({props:{queryID:"races",queryResult:a[2]}}),{c(){S(n.$$.fragment)},l(s){v(n.$$.fragment,s)},m(s,c){I(n,s,c),r=!0},p(s,c){const m={};c&4&&(m.queryResult=s[2]),n.$set(m)},i(s){r||(q(n.$$.fragment,s),r=!0)},o(s){C(n.$$.fragment,s),r=!1},d(s){L(n,s)}}}function Te(a){let n,r,s,c,m,f;return n=new z({props:{dest:"/sports/F1/drivers/",text:"Drivers"}}),s=new z({props:{dest:"/sports/F1/races/",text:"Races"}}),m=new z({props:{dest:"/sports/F1/circuits/",text:"Circuits"}}),{c(){S(n.$$.fragment),r=R(),S(s.$$.fragment),c=R(),S(m.$$.fragment)},l(t){v(n.$$.fragment,t),r=M(t),v(s.$$.fragment,t),c=M(t),v(m.$$.fragment,t)},m(t,_){I(n,t,_),E(t,r,_),I(s,t,_),E(t,c,_),I(m,t,_),f=!0},p:Q,i(t){f||(q(n.$$.fragment,t),q(s.$$.fragment,t),q(m.$$.fragment,t),f=!0)},o(t){C(n.$$.fragment,t),C(s.$$.fragment,t),C(m.$$.fragment,t),f=!1},d(t){L(n,t),t&&l(r),L(s,t),t&&l(c),L(m,t)}}}function Fe(a){let n,r,s,c,m,f,t,_,d,b,y,p,k;function h(e,o){return Ce}let g=h()(a);t=new we({props:{data:a[2].filter(a[10]),column:"name_year"}});let i=a[2]&&ee(a);return p=new Ee({props:{$$slots:{default:[Te]},$$scope:{ctx:a}}}),{c(){n=R(),g.c(),r=U("meta"),s=U("meta"),c=Y(),m=R(),f=U("h1"),S(t.$$.fragment),_=R(),i&&i.c(),d=R(),b=U("hr"),y=R(),S(p.$$.fragment),this.h()},l(e){n=M(e);const o=ie("svelte-1j2izld",document.head);g.l(o),r=D(o,"META",{name:!0,content:!0}),s=D(o,"META",{name:!0,content:!0}),c=Y(),o.forEach(l),m=M(e),f=D(e,"H1",{class:!0});var T=ue(f);v(t.$$.fragment,T),T.forEach(l),_=M(e),i&&i.l(e),d=M(e),b=D(e,"HR",{class:!0}),y=M(e),v(p.$$.fragment,e),this.h()},h(){A(r,"name","twitter:card"),A(r,"content","summary"),A(s,"name","twitter:site"),A(s,"content","@evidence_dev"),A(f,"class","markdown"),A(b,"class","markdown")},m(e,o){E(e,n,o),g.m(document.head,null),G(document.head,r),G(document.head,s),G(document.head,c),E(e,m,o),E(e,f,o),I(t,f,null),E(e,_,o),i&&i.m(e,o),E(e,d,o),E(e,b,o),E(e,y,o),I(p,e,o),k=!0},p(e,[o]){g.p(e,o);const T={};o&5&&(T.data=e[2].filter(e[10])),t.$set(T),e[2]?i?(i.p(e,o),o&4&&q(i,1)):(i=ee(e),i.c(),q(i,1),i.m(d.parentNode,d)):i&&(le(),C(i,1,1,()=>{i=null}),me());const N={};o&8388608&&(N.$$scope={dirty:o,ctx:e}),p.$set(N)},i(e){k||(q(t.$$.fragment,e),q(i),q(p.$$.fragment,e),k=!0)},o(e){C(t.$$.fragment,e),C(i),C(p.$$.fragment,e),k=!1},d(e){e&&l(n),g.d(e),l(r),l(s),l(c),e&&l(m),e&&l(f),L(t),e&&l(_),i&&i.d(e),e&&l(d),e&&l(b),e&&l(y),L(p,e)}}}function Re(a,...n){return!!n.some(r=>r==null?void 0:r.__unset)}function Me(a,n,r){var K,X;let s,c,m,f,t,_,d=Q,b=()=>(d(),d=pe(F,u=>r(9,_=u)),F),y,p;B(a,de,u=>r(0,y=u)),B(a,Z,u=>r(18,p=u)),a.$$.on_destroy.push(()=>d());let{data:k}=n,{data:h={},customFormattingSettings:V,__db:g,inputs:i}=k;ce(Z,p="d200decf47a51d92b634382dd2afac62",p);let e=be(i);J(ke,e),fe(e.subscribe(u=>i=u)),J(ge,{getCustomFormats:()=>V.customFormats||[]});const o=(u,$)=>x(g.query,u,{query_name:$});ye(o);const T=()=>{};let N=!1;(K=import.meta)!=null&&K.hot&&(void 0).on("vite:afterUpdate",()=>{N=!0,W.emptyCache()}),y.params,(X=import.meta)!=null&&X.hot&&(void 0).on("evidence:queryChange",({queryId:u,content:$})=>{let w=[];if(u||w.push("Malformed event: Missing queryId"),$||w.push("Malformed event: Missing content"),w.length){console.warn("Failed to update query on serverside change!",w.join(`
`));return}u==="races"&&r(7,s=$)});let P;_e(()=>r(5,P=s));let F;const te=()=>{const u=()=>{let $,w;try{if(f||N)$=void 0,w=void 0;else if(h.races){if(h.races instanceof Error)throw h.races;$=h.races}else $=x(g.query,s,{query_name:"races"})}catch(se){$=[],w=se}const H=W.create(s,o,"races",{scoreNotifier:T,initialData:$,initialError:w,noResolve:c});let j;H.loaded||(j=H.fetch()),F&&j instanceof Promise?j.then(()=>b(r(1,F=H))):b(r(1,F=H))};return u(),$e(u,500)};let O;const re=u=>u.year_race_name===y.params.year_race_name;return a.$$set=u=>{"data"in u&&r(3,k=u.data)},a.$$.update=()=>{a.$$.dirty&8&&r(4,{data:h={},customFormattingSettings:V,__db:g}=k,h),a.$$.dirty&16&&he.set(Object.keys(h).length>0),a.$$.dirty&1&&y.params,a.$$.dirty&160&&(P||r(5,P=s)),a.$$.dirty&128&&r(8,m=s),a.$$.dirty&288&&(f=m!==P),a.$$.dirty&192&&typeof O>"u"&&r(6,O=te()),a.$$.dirty&192&&O(),a.$$.dirty&80,a.$$.dirty&512&&r(2,t=_)},r(7,s=`select *,
year || '_' || REPLACE(name, ' ', '_') as year_race_name,
name || ' - ' || year as name_year,
'./' || year || '_' || REPLACE(name, ' ', '_') as race_link
from f1.races
order by date;`),c=Re`select *,
year || '_' || REPLACE(name, ' ', '_') as year_race_name,
name || ' - ' || year as name_year,
'./' || year || '_' || REPLACE(name, ' ', '_') as race_link
from f1.races
order by date;`,[y,F,t,k,h,P,O,s,m,_,re]}class Ue extends ae{constructor(n){super(),ne(this,n,Me,Fe,oe,{data:3})}}export{Ue as default};
